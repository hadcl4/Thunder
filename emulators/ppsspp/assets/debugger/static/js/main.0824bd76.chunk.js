(this["webpackJsonpppsspp-debugger"]=this["webpackJsonpppsspp-debugger"]||[]).push([[0],{168:function(e,t,n){},387:function(e,t,n){},427:function(e,t,n){},429:function(e,t,n){},430:function(e,t,n){},431:function(e,t,n){},432:function(e,t,n){},433:function(e,t,n){},434:function(e,t,n){},435:function(e,t,n){},436:function(e,t,n){},437:function(e,t,n){},448:function(e,t,n){},449:function(e,t,n){},450:function(e,t,n){},451:function(e,t,n){},452:function(e,t,n){},453:function(e,t,n){},454:function(e,t,n){},455:function(e,t,n){},456:function(e,t,n){},457:function(e,t,n){},472:function(e,t,n){"use strict";n.r(t);n(122),n(131),n(132),n(133),n(134),n(135),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(182),n(184),n(185),n(186),n(187),n(188),n(190),n(146),n(193),n(194),n(95),n(198),n(199),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(211),n(212),n(213),n(214),n(215),n(218),n(219),n(220),n(221),n(153),n(222),n(224),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(155),n(241),n(242),n(243),n(244),n(246),n(247),n(248),n(249),n(250),n(252),n(254),n(255),n(257),n(258),n(259),n(261),n(262),n(263),n(264),n(265),n(266),n(267),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(157),n(278),n(279),n(280),n(281),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(159),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(115),n(308),n(309),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(373),n(374),n(376),n(377),n(378),n(379),n(381),n(166);var s=n(1),r=n(58),a=n.n(r),i=n(118),o=n.n(i),c=(n(427),n(6)),l=n(8),u=n(9),d=n(15),p=n(14),h=n(120),f=n(29),b=n(31),m=n(99),v=n(59),g=n(32),j=["cpu.stepping","cpu.resume"],O=2,y=function(){function e(){Object(l.a)(this,e),this.onError=null,this.onClose=null,this.socket_=null,this.pendingTickets_={},this.listeners_={}}return Object(u.a)(e,[{key:"autoConnect",value:function(){var e=this;if(null!==this.socket_)return Promise.reject(new Error("Already connected, disconnect first"));var t=new Error("Couldn't connect");return fetch("//report.ppsspp.org/match/list").then((function(e){return e.json()})).then((function(t){return e.tryNextEndpoint_(t)})).then(this.setupSocket_.bind(this),(function(e){throw t.message=e.message,t.originalError=e,t}))}},{key:"connect",value:function(e){var t=this;if(null!==this.socket_)return Promise.reject(new Error("Already connected, disconnect first"));var n=new Error("Couldn't connect to "+e);return new Promise((function(s,r){var a=new WebSocket(e,"debugger.ppsspp.org");a.onopen=function(){t.socket_=a,s()},a.onclose=function(){r(n)}})).then(this.setupSocket_.bind(this))}},{key:"disconnect",value:function(){if(null===this.socket_)throw new Error("Not connected");this.failAllPending_("Disconnected from PPSSPP"),this.socket_.close(1e3),this.socket_=null}},{key:"listen",value:function(e,t){var n=this;return e in this.listeners_||(this.listeners_[e]=[]),this.listeners_[e].push(t),{remove:function(){var s=n.listeners_[e],r=s.indexOf(t);-1!==r&&s.splice(r,1)}}}},{key:"send",value:function(e){var t=this;if(null===this.socket_)return Promise.reject(new Error("Not connected"));var n=new Error("PPSSPP returned an error");return j.includes(e.event)?(this.socket_.send(JSON.stringify(e)),Promise.resolve(null)):new Promise((function(s,r){var a=t.makeTicket_();t.pendingTickets_[a]=function(e){"error"===e.event?(n.name="DebuggerError",n.message=e.message,n.originalMessage=e,r(n)):s(e)},t.socket_.send(JSON.stringify(Object(c.a)(Object(c.a)({},e),{},{ticket:a})))}))}},{key:"setupSocket_",value:function(){var e=this;this.socket_.onclose=function(){e.onClose&&e.onClose(),e.failAllPending_("PPSSPP disconnected"),e.socket_=null},this.socket_.onmessage=function(t){try{var n=JSON.parse(t.data);"error"===n.event&&e.handleError_(n.message,n.level);var s=!1;"ticket"in n&&(s=e.handleTicket_(n.ticket,n)),e.handleMessage_(n,s)}catch(r){e.handleError_("Failed to parse message from PPSSPP: "+r.message,O)}}}},{key:"tryNextEndpoint_",value:function(e){var t=this;return new Promise((function(n,s){if(!e||0===e.length)return s(new Error("Couldn't connect automatically.  Is PPSSPP connected to the same network?"));var r="ws://"+e[0].ip+":"+e[0].p+"/debugger";return t.connect(r).then(n,(function(r){e.length>1?n(t.tryNextEndpoint_(e.slice(1))):s(r)}))}))}},{key:"handleTicket_",value:function(e,t){if(e in this.pendingTickets_){var n=this.pendingTickets_[t.ticket];return delete this.pendingTickets_[t.ticket],n(t),!0}return this.handleError_("Received mismatched ticket: "+JSON.stringify(t),O),!1}},{key:"handleMessage_",value:function(e,t){t=this.executeHandlers_(e.event,e,t),this.executeHandlers_("*",e,t)}},{key:"executeHandlers_",value:function(e,t,n){if(e in this.listeners_){var s,r=Object(g.a)(this.listeners_[e]);try{for(r.s();!(s=r.n()).done;){(0,s.value)(t,n)&&(n=!0)}}catch(a){r.e(a)}finally{r.f()}}return n}},{key:"handleError_",value:function(e,t){this.onError?this.onError(e,t):void 0===t||Number(t)===O?console.error(e):console.log(e)}},{key:"makeTicket_",value:function(){var e=Math.random().toString(36).substr(2);return e in this.pendingTickets_?this.makeTicket_():e}},{key:"failAllPending_",value:function(e){var t={event:"error",message:e,level:O};for(var n in this.pendingTickets_)this.pendingTickets_.hasOwnProperty(n)&&this.pendingTickets_[n](t);this.pendingTickets_={}}}]),e}(),k=new(function(){function e(){Object(l.a)(this,e),this.changeCallbacks_=[],this.ppsspp_=null,this.connected_=!1}return Object(u.a)(e,[{key:"init",value:function(e){this.ppsspp_=e}},{key:"change",value:function(e){this.connected_=e;var t,n=Object(g.a)(this.changeCallbacks_);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(s){n.e(s)}finally{n.f()}}},{key:"onConnectionChange",value:function(e){var t=this;return this.changeCallbacks_.push(e),{remove:function(){var n=t.changeCallbacks_.indexOf(e);-1!==n&&t.changeCallbacks_.splice(n,1)}}}},{key:"onConnection",value:function(e){return this.connected_&&e(!0),this.onConnectionChange((function(t){t&&e(!0)}))}},{key:"listen",value:function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var s=void 0;s="connection"===n?this.onConnection(e[n]):"connection.change"===n?this.onConnectionChange(e[n]):this.ppsspp_.listen(n,e[n]),t.push(s)}return t}},{key:"forget",value:function(e){var t,n=Object(g.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.remove()}}catch(s){n.e(s)}finally{n.f()}}}]),e}()),x=function(){function e(){Object(l.a)(this,e),this.state={connected:!1,stepping:!1,paused:!0,started:!1,pc:0,currentThread:void 0,setState:void 0},this.stateListeners=[]}return Object(u.a)(e,[{key:"init",value:function(e){var t=this;this.state.setState=function(e){t.setState(e)},this.ppsspp_=e,this.listeners_=k.listen({connection:function(){return t.onConnection()},"connection.change":function(e){return t.onConnectionChange(e)},"cpu.stepping":function(e){return t.onStepping(e)},"cpu.resume":function(){return t.setState({stepping:!1})},"game.start":function(){t.setState({started:!0,paused:!1})},"game.quit":function(){t.setState({started:!1,stepping:!1,paused:!0,pc:0,currentThread:void 0})},"game.pause":function(){return t.setState({paused:!0})},"game.resume":function(){return t.setState({paused:!1})},"cpu.setReg":function(e){0===e.category&&32===e.register&&t.setState({pc:e.uintValue})},"cpu.getAllRegs":function(e){var n=e.categories[0].uintValues[32];t.setState({pc:n})}})}},{key:"shutdown",value:function(){k.forget(this.listeners_),this.listeners_=null}},{key:"onConnectionChange",value:function(e){this.setState({connected:e,started:!1,stepping:!1,paused:!0}),e||this.setState({currentThread:void 0})}},{key:"onConnection",value:function(){var e=this;this.ppsspp_.send({event:"cpu.status"}).then((function(t){var n=t.stepping,s=t.paused,r=t.pc,a=0!==r||n;e.setState({connected:!0,started:a,stepping:n,paused:s,pc:r})}),(function(t){e.setState({stepping:!1,paused:!0})}))}},{key:"onStepping",value:function(e){this.setState({stepping:!0,pc:e.pc})}},{key:"listenState",value:function(e){this.stateListeners.push(e)}},{key:"setState",value:function(e){var t=!1;for(var n in e)e[n]!==this.state[n]&&(t=!0);if(t){this.state=Object(c.a)(Object(c.a)({},this.state),e);var s,r=Object(g.a)(this.stateListeners);try{for(r.s();!(s=r.n()).done;){(0,s.value)(this.state)}}catch(a){r.e(a)}finally{r.f()}}}}]),e}(),S=n(0),C={ppsspp:null,gameStatus:null,log:function(e){return console.error(e)}},_=Object(s.createContext)(C);_.displayName="DebuggerContext";var w=_;function D(){return Object(s.useContext)(_)}function T(e){var t=e.children,n=e.gameStatus,s=e.log,r=e.ppsspp;return Object(S.jsx)(_.Provider,{value:{gameStatus:n,log:s,ppsspp:r},children:t})}var P=n(11);function N(e,t){return!(e.top<t.top||e.left<t.left)&&!(e.bottom>t.bottom||e.right>t.right)}function B(e,t){return!function(e){var t={top:0,left:0,bottom:window.innerHeight,right:window.innerWidth},n=e.getBoundingClientRect();if(!N(n,t))return!1;for(var s=e;null!==(s=s.parentNode);)if(s instanceof HTMLElement){var r=window.getComputedStyle(s),a=r.overflow+r.overflowX+r.overflowY;if("static"===r.position&&-1===a.indexOf("auto")&&-1===a.indexOf("scroll"))continue;if(!N(n,s.getBoundingClientRect()))return!1}return!0}(e)&&(e.scrollIntoView(t),!0)}var L=!1;function R(){return L}window.addEventListener("REACT_CONTEXTMENU_SHOW",(function(e){L=!0})),window.addEventListener("REACT_CONTEXTMENU_HIDE",(function(e){L=!1}));n(168);var M=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).handleRequestClose=function(){e.props.confirmClose&&!window.confirm(e.props.confirmClose)||e.props.onClose()},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(S.jsx)(o.a,Object(c.a)({className:"ReactModal__FitContent",overlayClassName:"ReactModal__FitOverlay",onRequestClose:this.handleRequestClose,closeTimeoutMS:150},this.props))}}]),n}(s.PureComponent),A=n(394),V=n(75),F=["label","type","children","onChange","component","prop"],E=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).handleChange=function(t){if(e.props.onChange)e.props.onChange(t);else if(e.props.component){var n=t.target,s=n.dataset.prop||e.props.prop,r="checkbox"===n.type?n.checked:n.value;e.props.component.setState(Object(V.a)({},s,r))}},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.children;return Object(S.jsxs)("div",{className:"Field",children:[Object(S.jsx)("label",{className:"Field__label",htmlFor:this.fieldID(),children:t}),this.renderInput(),n]})}},{key:"renderInput",value:function(){return"text"===this.props.type?this.renderText():"hex"===this.props.type?this.renderHex():"radio"===this.props.type?this.renderRadio():"checkboxes"===this.props.type?this.renderCheckboxes():null}},{key:"renderText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props,n=(t.label,t.type,t.children,t.onChange,t.component,t.prop,Object(A.a)(t,F));return n.value=this.fieldValue(),Object(S.jsx)("input",Object(c.a)(Object(c.a)({type:"text",id:this.fieldID(),onChange:this.handleChange},n),e))}},{key:"renderHex",value:function(){return this.renderText({pattern:"(0x)?[0-9A-Fa-f]+",title:"Hexadecimal value"})}},{key:"renderRadio",value:function(){var e=this,t=this.fieldValue();return this.props.options.map((function(n){var s={name:e.fieldID(),value:n.value,checked:t===n.value,onChange:e.handleChange,disabled:e.props.disabled};return Object(S.jsxs)("label",{children:[Object(S.jsx)("input",Object(c.a)({type:"radio"},s))," "+n.label]},n.value)}))}},{key:"renderCheckboxes",value:function(){var e=this;return this.props.options.map((function(t){var n={"data-prop":t.value,checked:e.props.component.state[t.value],onChange:e.handleChange,disabled:e.props.disabled};return Object(S.jsxs)("label",{children:[Object(S.jsx)("input",Object(c.a)({type:"checkbox"},n))," "+t.label]},t.value)}))}},{key:"fieldID",value:function(){var e=this.props,t=e.id,n=e.component,s=e.prop;return!t&&n&&s?(n.displayName||n.constructor.name)+"__"+s:t}},{key:"fieldValue",value:function(){var e=this.props,t=e.value,n=e.component,s=e.prop;return void 0===t&&n&&s?n.state[s]:t}}]),n}(s.Component),U=n(5),I=n.n(U),H=n(16);n(429);function G(e){return Object(S.jsxs)("form",{action:"#",className:Object(H.a)(e.className,"Form"),onSubmit:e.onSubmit,children:[e.heading?Object(S.jsx)("h2",{className:"Form__heading",children:e.heading}):null,e.children]})}G.Buttons=function(e){var t=!0!==e.onSave?e.onSave:void 0,n=e.onSave?Object(S.jsx)("button",{type:"submit",onClick:t,children:"Save"}):null,s=e.onCancel?Object(S.jsx)("button",{type:"button",onClick:e.onCancel,children:"Cancel"}):null;return Object(S.jsxs)("div",{className:"Form__buttons",children:[e.children,n,s]})},G.Buttons.propTypes={onSave:I.a.oneOfType([I.a.func,I.a.bool]),onCancel:I.a.func,children:I.a.node};var z=G,q=function(){function e(t,n){Object(l.a)(this,e),this.func=t,this.ms=n}return Object(u.a)(e,[{key:"start",value:function(){var e=this;this.cancel(),this.handle=setTimeout((function(){e.handle=null,e.func()}),this.ms)}},{key:"reset",value:function(e){this.func=e}},{key:"runEarly",value:function(){this.handle&&(this.cancel(),this.func())}},{key:"cancel",value:function(){null!==this.handle&&(clearTimeout(this.handle),this.handle=null)}}]),e}();function W(e){return("00000000"+e.toString(16).toUpperCase()).substr(-8)}n(430);var K=[{label:"Memory",value:"memory"},{label:"Execute",value:"execute"}],J=[{label:"Read",value:"read"},{label:"Write",value:"write"},{label:"On change",value:"change"}],X=[{label:"Break",value:"enabled"},{label:"Log",value:"log"}],Y=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).state={},s.cleanState={isOpen:!1,derivedBreakpoint:null},s.cleanBreakpoint={type:"memory",address:"",size:"0x00000001",condition:"",logFormat:"",read:!0,write:!0,change:!1,enabled:!0,log:!0},s.onSave=function(e){var t=s.context.ppsspp.send({event:"cpu.evaluate",thread:s.context.gameStatus.currentThread,expression:s.state.address});if(s.props.breakpoint){var n=s.state,r=n.derivedBreakpoint,a=n.address,i=n.size,o=n.type;t=o!==r.type||r.address!==a||"memory"===o&&r.size!==i?t.then(s.deleteOld).then(s.saveNew):t.then(s.updateExisting)}else t=t.then(s.saveNew);t.then(s.onClose,(function(e){window.alert(e.message)})),e.preventDefault()},s.saveNew=function(e){var t=e.uintValue;return s.context.ppsspp.send(Object(c.a)(Object(c.a)({event:s.getEvent(s.state.type,"add")},s.state),{},{address:t}))},s.deleteOld=function(e){var t=e.uintValue;return s.context.ppsspp.send({event:s.getEvent(s.props.breakpoint.type,"remove"),address:s.props.breakpoint.address,size:s.props.breakpoint.size}).then((function(){return{uintValue:t}}))},s.updateExisting=function(e){var t=e.uintValue;return s.context.ppsspp.send(Object(c.a)(Object(c.a)({event:s.getEvent(s.state.type,"update")},s.state),{},{address:t}))},s.onClose=function(){s.cleanTimeout.start(),s.props.onClose()},Object.assign(s.state,Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)({},s.cleanState),s.cleanBreakpoint),e.breakpoint),e.initialOverrides)),s.cleanTimeout=new q((function(){s.setState(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)({},s.cleanState),s.cleanBreakpoint),s.props.breakpoint),s.props.initialOverrides))}),200),s}return Object(u.a)(n,[{key:"render",value:function(){var e=!!this.props.breakpoint;return Object(S.jsx)(M,{contentLabel:"Breakpoint settings",isOpen:this.props.isOpen,onClose:this.onClose,confirmClose:this.hasChanges()?"Discard changes?":null,children:Object(S.jsxs)(z,{heading:e?"Edit Breakpoint":"Create Breakpoint",onSubmit:this.onSave,className:"BreakpointModal",children:[Object(S.jsx)(E,{type:"radio",label:"Type",options:K,prop:"type",component:this}),Object(S.jsx)(E,{type:"text",label:"Address",prop:"address",component:this}),this.renderMemory(),this.renderExecute(),Object(S.jsx)(E,{type:"text",label:"Log format",prop:"logFormat",component:this,disabled:!this.state.log}),Object(S.jsx)(E,{type:"checkboxes",label:"Actions",options:X,component:this}),Object(S.jsx)(z.Buttons,{onSave:!0,onCancel:this.onClose})]})})}},{key:"renderMemory",value:function(){return"memory"!==this.state.type?null:Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(E,{type:"hex",label:"Size",prop:"size",component:this}),Object(S.jsx)(E,{type:"checkboxes",label:"Operations",options:J,component:this})]})}},{key:"renderExecute",value:function(){return"execute"!==this.state.type?null:Object(S.jsx)(E,{type:"text",label:"Condition",prop:"condition",component:this})}},{key:"hasChanges",value:function(){var e=this,t=this.state.derivedBreakpoint||this.cleanBreakpoint;return void 0!==Object.keys(t).find((function(n){return e.state[n]!==t[n]}))}},{key:"componentDidUpdate",value:function(e,t){this.props.isOpen&&null!=this.cleanTimeout&&this.cleanTimeout.runEarly()}},{key:"getEvent",value:function(e,t){if("execute"===e)return"cpu.breakpoint."+t;if("memory"===e)return"memory.breakpoint."+t;throw new Error("Unexpected type: "+e)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.isOpen&&!t.isOpen){var n=e.breakpoint;n&&(n.address="0x"+W(n.address),n.size&&(n.size="0x"+W(n.size)),n.condition=n.condition||"",n.logFormat=n.logFormat||"");var s=e.initialOverrides;return s&&(s.address="0x"+W(s.address),s.size&&(s.size="0x"+W(s.size))),Object(c.a)(Object(c.a)({isOpen:!0},n),{},{derivedBreakpoint:n},s)}return!e.isOpen&&t.derivedBreakpoint?{derivedBreakpoint:null}:null}}]),n}(s.PureComponent);Y.contextType=w;var $=Y;var Q=Object(P.d)("breakpointPanel")((function(e){var t=e.id,n=e.trigger;return Object(S.jsxs)(P.a,{id:t,children:[(null===n||void 0===n?void 0:n.breakpoint)?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(P.c,{onClick:function(){return e.toggleBreakpoint(n.breakpoint)},children:"Toggle Break"}),Object(S.jsx)(P.c,{onClick:function(){return e.editBreakpoint(n.breakpoint)},children:"Edit\u2026"}),Object(S.jsx)(P.c,{onClick:function(){return e.removeBreakpoint(n.breakpoint)},children:"Remove"}),Object(S.jsx)(P.c,{divider:!0})]}):null,Object(S.jsx)(P.c,{onClick:function(){return e.createBreakpoint()},children:"Add New\u2026"})]})}));n(431);function Z(e){var t=D(),n=e.breakpoint,s=function(e){return{breakpoint:n}},r={onDoubleClick:function(){return e.gotoBreakpoint(n),!1},onMouseDown:function(){return e.onSelect(),!1},className:e.selected?"BreakpointPanelItem--selected":null},a=Object(S.jsx)("td",{className:"BreakpointPanelItem__break-check-cell",children:Object(S.jsx)("input",{type:"checkbox",checked:n.enabled,className:"BreakpointPanelItem__break-check",onChange:function(){return e.toggleBreakpoint(n)}})});return"execute"===n.type?Object(S.jsxs)(P.b,{id:"breakpointPanel",renderTag:"tr",holdToDisplay:-1,attributes:r,collect:s,children:[a,Object(S.jsx)("td",{children:"Execute"}),Object(S.jsxs)("td",{children:["0x",W(n.address)]}),Object(S.jsx)("td",{children:n.symbol||"-"}),Object(S.jsx)("td",{children:n.code||"-"}),Object(S.jsx)("td",{children:n.condition||"-"}),Object(S.jsx)("td",{children:"-"})]}):"memory"===n.type?Object(S.jsxs)(P.b,{id:"breakpointPanel",renderTag:"tr",holdToDisplay:-1,attributes:r,collect:s,children:[a,Object(S.jsx)("td",{children:ee(n)}),Object(S.jsxs)("td",{children:["0x",W(n.address)]}),Object(S.jsxs)("td",{children:["0x",W(n.size)]}),Object(S.jsx)("td",{children:n.code||"-"}),Object(S.jsx)("td",{children:n.condition||"-"}),Object(S.jsx)("td",{children:n.hits})]}):(t.log("Unhandled breakpoint type: "+n.type),null)}function ee(e){var t,n=e.write,s=e.read,r=e.change;return!s&&!n||!n&&s&&r?"Invalid":(s&&n?t="Read/Write":s?t="Read":n&&(t="Write"),r?t+" Change":t)}n(432);function te(e){var t=D(),n=e.breakpoints,r=e.selectedRow,a=e.setSelectedRow,i=e.gotoDisasm,o=Object(s.useState)(null),c=Object(v.a)(o,2),l=c[0],u=c[1],d=Object(s.useState)(!1),p=Object(v.a)(d,2),h=p[0],f=p[1],b=function(e){"execute"===e.type?t.ppsspp.send({event:"cpu.breakpoint.update",address:e.address,enabled:!e.enabled}):"memory"===e.type&&t.ppsspp.send({event:"memory.breakpoint.update",address:e.address,size:e.size,enabled:!e.enabled})},m=function(e){"execute"===e.type?t.ppsspp.send({event:"cpu.breakpoint.remove",address:e.address}):"memory"===e.type&&t.ppsspp.send({event:"memory.breakpoint.remove",address:e.address,size:e.size})},g=function(e){"execute"===e.type?i(e.address):e.type};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(P.b,{id:"breakpointPanel",renderTag:"div",holdToDisplay:-1,attributes:{id:"BreakpointPanelList"},children:[Object(S.jsxs)("table",{className:"BreakpointPanelList__table",onKeyDown:function(e){if(!R()){"ArrowUp"===e.key&&r>0&&(a(r-1),e.preventDefault()),"ArrowDown"===e.key&&r<n.length-1&&(a(r+1),e.preventDefault());var t=n[r];t&&("ArrowRight"===e.key&&(g(t),e.preventDefault())," "===e.key&&(b(t),e.preventDefault()),"Enter"===e.key&&(u(t),e.preventDefault()),"Delete"===e.key&&(m(t),e.preventDefault()))}},tabIndex:0,children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{children:"Break"}),Object(S.jsx)("th",{children:"Type"}),Object(S.jsx)("th",{children:"Offset"}),Object(S.jsx)("th",{children:"Size/Label"}),Object(S.jsx)("th",{children:"Opcode"}),Object(S.jsx)("th",{children:"Condition"}),Object(S.jsx)("th",{children:"Hits"})]})}),Object(S.jsxs)("colgroup",{children:[Object(S.jsx)("col",{className:"BreakpointPanelList__table-column-break"}),Object(S.jsx)("col",{className:"BreakpointPanelList__table-column"}),Object(S.jsx)("col",{className:"BreakpointPanelList__table-column"}),Object(S.jsx)("col",{className:"BreakpointPanelList__table-column"}),Object(S.jsx)("col",{className:"BreakpointPanelList__table-column"}),Object(S.jsx)("col",{className:"BreakpointPanelList__table-column"}),Object(S.jsx)("col",{className:"BreakpointPanelList__table-column-hits"})]}),Object(S.jsx)("tbody",{children:n.map((function(e,t){return Object(S.jsx)(Z,{breakpoint:e,selected:t===r,gotoBreakpoint:g,toggleBreakpoint:b,onSelect:function(){return a(t)}},"".concat(e.address,"-").concat(e.size||0))}))})]}),0===n.length?Object(S.jsx)("div",{className:"BreakpointPanelList__no-breakpoints",children:"No breakpoints set"}):null]}),Object(S.jsx)($,{isOpen:!(!l&&!h),onClose:function(){u(null),f(!1)},breakpoint:l}),Object(S.jsx)(Q,{toggleBreakpoint:b,editBreakpoint:function(e){return u(e)},removeBreakpoint:m,createBreakpoint:function(){return f(!0)}})]})}function ne(e){var t=D(),n=Object(s.useState)([]),r=Object(v.a)(n,2),a=r[0],i=r[1],o=Object(s.useState)([]),l=Object(v.a)(o,2),u=l[0],d=l[1],p=Object(s.useState)(-1),h=Object(v.a)(p,2),f=h[0],b=h[1],g=[].concat(Object(m.a)(u),Object(m.a)(a)),j=Object(s.useCallback)((function(){t.gameStatus.started&&t.ppsspp.send({event:"cpu.breakpoint.list"}).then((function(e){var t=e.breakpoints;i(t.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{type:"execute"})})))}),(function(){i([])}))}),[t.ppsspp,t.gameStatus.started]),O=Object(s.useCallback)((function(){t.gameStatus.started&&t.ppsspp.send({event:"memory.breakpoint.list"}).then((function(e){var t=e.breakpoints;d(t.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{type:"memory"})})))}),(function(){d([])}))}),[t.ppsspp,t.gameStatus.started]),y=Object(s.useCallback)((function(){j(),O()}),[j,O]),x=Object(s.useCallback)((function(){i([]),d([]),b(-1)}),[]);return Object(s.useEffect)((function(){var e=k.listen({"game.start":function(){return y()},"game.quit":function(){return x()},connection:function(){return y()},"cpu.stepping":function(){return y()},"cpu.breakpoint.add":function(){return j()},"cpu.breakpoint.update":function(){return j()},"cpu.breakpoint.remove":function(){return j()},"memory.breakpoint.add":function(){return O()},"memory.breakpoint.update":function(){return O()},"memory.breakpoint.remove":function(){return O()}});return function(){return k.forget(e)}}),[y,j,O,x]),Object(S.jsx)(te,{breakpoints:g,selectedRow:f,setSelectedRow:b,gotoDisasm:e.gotoDisasm})}var se=!0,re=[];function ae(){var e=document.getElementById("clipboard-scratchpad");return e||function(){var e=document.createElement("div");return e.id="clipboard-scratchpad",e.style.width=1,e.style.height=1,e.style.opacity=0,e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.pointerEvents="none",e.style.whiteSpace="pre",document.body.appendChild(e),e}()}function ie(e){se=!1;try{var t=ae();t.textContent=e;var n=t.firstChild,s=document.createRange();s.setStart(n,0),s.setEnd(n,e.length);var r=window.getSelection(),a=0!==r.rangeCount?r.getRangeAt(0):null;r.removeAllRanges(),r.addRange(s);try{document.execCommand("copy")}catch(i){window.prompt("Use Ctrl-C or Command-C to copy",e)}r.removeAllRanges(),a&&r.addRange(a)}finally{se=!0}}function oe(e,t){for(;e&&e!==document;){if(e.matches(t))return!0;e=e.parentNode}return!1}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),document.addEventListener("copy",(function(e){var t=0!==document.getSelection().rangeCount?document.getSelection().getRangeAt(0):null;if((!t||t.collapsed)&&se){var n,s=Object(g.a)(re);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(oe(document.activeElement,r.selector)){var a=r.handler(e);a&&(/win/i.test(window.navigator.platform)?e.clipboardData.setData("text/plain",a.replace(/\n/g,"\r\n")):e.clipboardData.setData("text/plain",a),e.preventDefault())}}}catch(i){s.e(i)}finally{s.f()}}}));var ce=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).handleCopyAddress=function(e,t){ie(W(t.line.address)),t.node.focus()},e.handleCopyHex=function(t,n){ie(e.props.getSelectedLines().map((function(e){return e.macroEncoding?e.macroEncoding.map(W).join("\n"):W(e.encoding)})).join("\n")),n.node.focus()},e.handleCopyDisasm=function(t,n){ie(e.props.getSelectedDisasm()),n.node.focus()},e.handleAssemble=function(t,n){setTimeout((function(){e.props.assembleInstruction(n.line,"").catch((function(){}))}),0)},e.handleRunUntil=function(t,n){e.context.ppsspp.send({event:"cpu.runUntil",address:n.line.address}).catch((function(){})),n.node.focus()},e.handleJumpPC=function(t,n){e.context.ppsspp.send({event:"cpu.setReg",thread:e.context.gameStatus.currentThread,name:"pc",value:n.line.address}).catch((function(t){e.context.log("Failed to update PC: "+t)}))},e.handleToggleBreakpoint=function(t,n){e.props.toggleBreakpoint(n.line)},e.handleFollowBranch=function(t,n){e.props.followBranch(!0,n.line)},e.handleTodo=function(e,t){console.log(t),t.node.focus()},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.trigger,s=!this.context.gameStatus.stepping||this.context.gameStatus.paused,r=n&&n.line,a=r&&(null!==r.branch||null!==r.relevantData||"data"===r.type);return Object(S.jsxs)(P.a,{id:t,children:[Object(S.jsx)(P.c,{onClick:this.handleCopyAddress,children:"Copy Address"}),Object(S.jsx)(P.c,{onClick:this.handleCopyHex,children:"Copy Instruction (Hex)"}),Object(S.jsx)(P.c,{onClick:this.handleCopyDisasm,children:"Copy Instruction (Disasm)"}),Object(S.jsx)(P.c,{divider:!0}),Object(S.jsx)(P.c,{disabled:s,onClick:this.handleAssemble,children:"Assemble Opcode..."}),Object(S.jsx)(P.c,{divider:!0}),Object(S.jsx)(P.c,{disabled:s,onClick:this.handleRunUntil,children:"Run to Cursor"}),Object(S.jsx)(P.c,{disabled:s,onClick:this.handleJumpPC,children:"Jump to Cursor"}),Object(S.jsx)(P.c,{onClick:this.handleToggleBreakpoint,children:"Toggle Breakpoint"}),Object(S.jsx)(P.c,{divider:!0}),Object(S.jsx)(P.c,{disabled:!a,onClick:this.handleFollowBranch,children:"Follow Branch"}),Object(S.jsx)(P.c,{data:{action:"goto_memory"},onClick:this.handleTodo,children:"Go to in Memory View"}),Object(S.jsx)(P.c,{data:{action:"goto_jit"},onClick:this.handleTodo,children:"Go to in Jit Compare"}),Object(S.jsx)(P.c,{divider:!0}),Object(S.jsx)(P.c,{data:{action:"func_rename"},onClick:this.handleTodo,children:"Rename Function..."}),Object(S.jsx)(P.c,{data:{action:"func_remove"},onClick:this.handleTodo,children:"Remove Function"}),Object(S.jsx)(P.c,{data:{action:"func_add"},onClick:this.handleTodo,children:"Add Function Here"})]})}}]),n}(s.PureComponent);ce.contextType=w;var le=Object(P.d)("disasm")(ce),ue=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.calcPos();if(null===e||0===this.props.lineHeight)return null;var t=Object(H.a)({DisasmBranchGuide:!0,"DisasmBranchGuide--selected":this.props.selected});return Object(S.jsx)("div",{className:t,style:e,children:Object(S.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:e.height,children:Object(S.jsx)("path",{d:this.buildPath(e.height)})})})}},{key:"buildPath",value:function(e){var t=this.props,n=t.guide,s=t.range,r=t.lineHeight,a=Math.floor(r/2)+.5,i="m7.5,-".concat(a," l0,").concat(r," m-7.5,-").concat(r-a),o="m3,0 l5,0 m-8,0",c="m5.5,-4 l-4,4 l4,4 m-3.5,-4 l6,0 m-8,0",l=["M0,"+a];return n.top<s.start?l.push(i):"up"===n.direction?l.push(c):l.push(o),l.push("m7.5,0 l0,"+(e-r)+" m-7.5,0"),n.bottom>=s.end?l.push(i):"down"===n.direction?l.push(c):l.push(o),l.join(" ")}},{key:"calcPos",value:function(){var e=this.props.guide,t=this.findAddressOffset(e.top,!1),n=this.findAddressOffset(e.bottom,!0);return null===t||null===n?null:{top:t,right:8*(16-e.lane),height:n-t}}},{key:"findAddressOffset",value:function(e,t){var n,s=this.props,r=s.offsets,a=s.range;if(e>=a.end)return a.end-4 in r&&t?r[a.end-4]+this.props.lineHeight:a.end-8 in r&&t?r[a.end-8]+this.props.lineHeight:null;if(e<a.start&&!t)n=0;else if(e in r)n=r[e];else{if(!(e-4 in r))return null;n=r[e-4]}return t?n+this.props.lineHeight:n}}]),n}(s.PureComponent);function de(e){return Object(S.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:e.className,viewBox:"0 0 1536 1536",width:"12",height:"12",children:Object(S.jsx)("path",{d:"M768,0 q209,0 385.5,103 t279.5,279.5 t103,385.5 t-103,385.5 t-279.5,279.5 t-385.5,103 t-385.5,-103 t-279.5,-279.5 t-103,-385.5 t103,-385.5 t279.5,-279.5 t385.5,-103 zm128,1247 v-190 q0,-14 -9,-23.5 t-22,-9.5 h-192 q-13,0 -23,10 t-10,23 v190 q0,13 10,23 t23,10 h192 q13,0 22,-9.5 t9,-23.5 zm-2,-344 l18,-621 q0,-12 -10,-18 q-10,-8 -24,-8 h-220 q-14,0 -24,8 q-10,6 -10,18 l17,621 q0,10 10,17.5 t24,7.5 h185 q14,0 23.5,-7.5 t10.5,-17.5 z"})})}var pe=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).ref=Object(s.createRef)(),r}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.line,s=t.selected,r=t.focused,a=t.cursor,i=Object(H.a)({DisasmLine:!0,"DisasmLine--selected":s&&!r,"DisasmLine--focused":r,"DisasmLine--cursor":a,"DisasmLine--breakpoint":n.breakpoint&&n.breakpoint.enabled,"DisasmLine--disabled-breakpoint":n.breakpoint&&!n.breakpoint.enabled,"DisasmLine--current":n.isCurrentPC}),o=function(t){return{line:n,node:e.ref.current.parentNode}},c={onDoubleClick:function(t){return e.onDoubleClick(t,o())},tabIndex:0};return Object(S.jsx)(P.b,{id:this.props.contextmenu,renderTag:"a",collect:o,attributes:c,holdToDisplay:-1,children:Object(S.jsxs)("div",{className:i,style:{backgroundColor:n.backgroundColor},ref:this.ref,"data-address":n.address,children:[Object(S.jsx)(de,{className:"DisasmLine__breakpoint-icon"}),this.renderAddress(n),Object(S.jsxs)("code",{className:"DisasmLine__opcode",children:[this.highlight(n.name,"",n.params)," "]}),Object(S.jsxs)("code",{className:"DisasmLine__params",children:[this.highlightParams(n.params,n.name,""),this.renderConditional(n)]})]})})}},{key:"renderAddress",value:function(e){var t=e.symbol,n=e.address,s=e.encoding,r=W(n);return this.props.displaySymbols?null!==t?Object(S.jsx)("code",{className:"DisasmLine__address DisasmLine__address--symbol",children:this.highlight(t+":")}):Object(S.jsx)("code",{className:"DisasmLine__address DisasmLine__address--nosymbol",children:this.highlight(r)}):Object(S.jsxs)("code",{className:"DisasmLine__address DisasmLine__address--hexonly",children:[this.highlight(r)," ",W(s)]})}},{key:"renderConditional",value:function(e){return e.isCurrentPC&&null!==e.conditionMet?e.conditionMet?" ; true":" ; false":""}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=this.props.highlight;if(null!==s){var r=(t?t+" ":"")+e+" "+n,a=r.toLowerCase().indexOf(s),i=s.length;if(-1!==a){var o=t?t.length+1:0;a<o?a=(i-=o-a)>0?0:-1:a-=o}if(a>=0&&a<e.length){var c=Object(H.a)({DisasmLine__highlight:!0,"DisasmLine__highlight--end":a+i>e.length+1});return Object(S.jsxs)(S.Fragment,{children:[e.substr(0,a),Object(S.jsx)("span",{className:c,children:e.substr(a,i)}),e.substr(a+i)]})}}return e}},{key:"highlightParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=this.props,r=s.highlight,a=s.highlightParams;if(null===r){var i=e.split(/([,()])/),o=a||[];return i.map((function(e,t){var n="DisasmLine__param";return o.includes(e)&&(n+=" DisasmLine__param--highlighted"),Object(S.jsx)("span",{className:n,children:e},t)}))}return this.highlight(e,t,n)}},{key:"onDoubleClick",value:function(e,t){0===e.button&&this.props.onDoubleClick(e,t)}},{key:"ensureInView",value:function(e){var t=this.ref.current.parentNode;!1!==e&&B(t,{block:e}),t.focus()}}],[{key:"addressBoundingTop",value:function(e,t){var n=e.querySelector('.DisasmLine[data-address="'+t+'"]');return n?n.parentNode.getBoundingClientRect().top:null}}]),n}(s.PureComponent),he=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={mouseDown:!1,focused:!1,lineOffsets:{},pendingLineParams:[],selectedLineParams:[],prevLines:null,prevSelectionTop:null,prevSelectionBottom:null},r.onCopy=function(e){return r.props.getSelectedDisasm()},r.ref=Object(s.createRef)(),r.cursorRef=Object(s.createRef)(),r.focusTimeout=new q((function(){return null}),20),r.paramsTimeout=new q((function(){r.setState((function(e){return{selectedLineParams:e.pendingLineParams}}))}),20),r}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t={onMouseDownCapture:function(t){return e.onMouseDown(t)},onMouseUpCapture:this.state.mouseDown?function(t){return e.onMouseUp(t)}:void 0,onMouseMove:this.state.mouseDown?function(t){return e.onMouseMove(t)}:void 0,onKeyDown:function(t){return e.onKeyDown(t)},onBlur:function(t){return e.onFocusChange(t,!1)},onFocus:function(t){return e.onFocusChange(t,!0)}};return Object(S.jsxs)("div",Object(c.a)(Object(c.a)({className:"Disasm__list",ref:this.ref},t),{},{children:[this.props.lines.map((function(t){return e.renderLine(t)})),this.props.branchGuides.map((function(t){return e.renderBranchGuide(t)}))]}))}},{key:"renderLine",value:function(e){var t=this.props,n=t.displaySymbols,s=t.cursor,r={displaySymbols:n,line:e,selected:this.isLineSelected(e),cursor:e.address===s,onDoubleClick:this.props.onDoubleClick,ref:e.address===s?this.cursorRef:void 0,highlight:this.shouldHighlight(e,this.props.highlightText)?this.props.highlightText:null,highlightParams:this.shouldHighlightParams(e)?this.state.selectedLineParams:null};return r.focused=r.selected&&this.state.focused,Object(S.jsx)(pe,Object(c.a)({contextmenu:"disasm"},r),e.address)}},{key:"renderBranchGuide",value:function(e){var t=String(e.top)+String(e.bottom)+e.direction,n=this.props,s=n.range,r=n.lineHeight,a=n.cursor,i={key:t,guide:e,offsets:this.state.lineOffsets,range:s,lineHeight:r,selected:e.top===a||e.bottom===a};return Object(S.jsx)(ue,Object(c.a)({},i))}},{key:"shouldHighlight",value:function(e,t){var n=[];return n.push(W(e.address)),null!==e.symbol&&n.push(e.symbol+":"),n.push(e.name+" "+e.params),n.some((function(e){return-1!==e.toLowerCase().indexOf(t)}))}},{key:"shouldHighlightParams",value:function(e,t){return!this.isLineSelected(e)&&this.state.selectedLineParams.some((function(t){return-1!==e.params.indexOf(t)}))}},{key:"addressBoundingTop",value:function(e){return pe.addressBoundingTop(this.ref.current,e)}},{key:"ensureCursorInView",value:function(e){this.cursorRef.current&&this.cursorRef.current.ensureInView(e)}},{key:"isLineSelected",value:function(e){return n.isLineSelected(this.props,e)}},{key:"componentDidMount",value:function(){var e,t;e=".Disasm__list",t=this.onCopy,re.push({selector:e,handler:t})}},{key:"componentWillUnmount",value:function(){var e,t;e=".Disasm__list",t=this.onCopy,re=re.filter((function(n){return n.selector!==e&&n.handler!==t})),this.paramsTimeout.cancel()}},{key:"componentDidUpdate",value:function(e,t){this.state.pendingLineParams!==t.pendingLineParams&&this.paramsTimeout.start()}},{key:"onFocusChange",value:function(e,t){var n=this,s=function(){t!==n.state.focused&&n.setState({focused:t})};this.focusTimeout.cancel(),t?s():(this.focusTimeout.reset(s),this.focusTimeout.start())}},{key:"onMouseDown",value:function(e){var t=this.mouseEventToLine(e);2===e.button&&this.isLineSelected(t)?this.props.updateCursor(t.address):this.applySelection(e,t),0===e.button&&this.setState({mouseDown:!0})}},{key:"onMouseUp",value:function(e){var t=this.mouseEventToLine(e);t&&this.applySelection(e,t),this.setState({mouseDown:!1})}},{key:"onMouseMove",value:function(e){if(0!==e.buttons){var t=this.mouseEventToLine(e);t&&this.applySelection(e,t)}else this.setState({mouseDown:!1})}},{key:"onKeyDown",value:function(e){if(!R()){var t=(e.ctrlKey?"c":"")+(e.metaKey?"m":"")+(e.altKey?"a":"")+(e.shiftKey?"s":"");if(["ArrowUp","ArrowDown","PageUp","PageDown"].includes(e.key)){var n=1;if("PageUp"!==e.key&&"PageDown"!==e.key||(n=this.props.visibleLines),"ArrowUp"!==e.key&&"PageUp"!==e.key||(n=-n),""===t||"s"===t){var s=this.findCursorLineIndex(),r=Math.min(this.props.lines.length-1,Math.max(0,s+n));s!==r&&(this.applySelection(e,this.props.lines[r]),e.preventDefault())}else e.ctrlKey&&(this.props.applyScroll(n),e.preventDefault())}"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||""!==t||(this.props.followBranch("ArrowRight"===e.key,this.findCursorLine()),e.preventDefault()),"Tab"===e.key&&""===t&&(this.props.updateDisplaySymbols(!this.props.displaySymbols),e.preventDefault()),"a"===e.key&&"c"===t&&(this.props.assembleInstruction(this.findCursorLine(),""),e.preventDefault())," "!==e.key&&"Spacebar"!==e.key||""!==t||(this.props.toggleBreakpoint(this.findCursorLine()),e.preventDefault()),"d"===e.key&&"c"===t&&(this.props.toggleBreakpoint(this.findCursorLine(),!0),e.preventDefault()),"s"!==e.key&&"f"!==e.key||"c"!==t||(this.props.searchPrompt(),e.preventDefault()),"F3"===e.key&&""===t&&(this.props.searchNext(),e.preventDefault()),"g"===e.key&&"c"===t&&(this.props.promptGoto(),e.preventDefault()),"e"===e.key&&"c"===t&&(this.props.editBreakpoint(this.findCursorLine()),e.preventDefault())}}},{key:"applySelection",value:function(e,t){var n=this.props,s=n.selectionTop,r=n.selectionBottom;e.shiftKey?(s=Math.min(s,t.address),r=Math.max(r,t.address)):(s=t.address,r=t.address),s===this.props.selectionTop&&r===this.props.selectionBottom||this.props.updateSelection({selectionTop:s,selectionBottom:r}),this.props.updateCursor(t.address)}},{key:"mouseEventToLine",value:function(e){var t=e.pageY-this.ref.current.getBoundingClientRect().top-window.pageYOffset,n=Math.floor(t/this.props.lineHeight);return this.props.lines[n]}},{key:"findCursorLineIndex",value:function(){for(var e=this.props,t=e.cursor,n=e.lines,s=e.selectionTop,r=t||s,a=0;a<n.length;++a)if(n[a].address===r)return a}},{key:"findCursorLine",value:function(){var e=this.findCursorLineIndex();return this.props.lines[e]}}],[{key:"isLineSelected",value:function(e,t){var n=e.selectionTop,s=e.selectionBottom;return t.address+t.addressSize>n&&t.address<=s}},{key:"calcOffsets",value:function(e,t){var n=0,s={};return e.forEach((function(e){s[e.address]=n,n+=t})),s}},{key:"getSelectedLineParams",value:function(e){var t,s=e.lines,r=e.selectionTop,a=e.selectionBottom,i=s.filter(n.isLineSelected.bind(null,{selectionTop:r,selectionBottom:a})),o={},c=Object(g.a)(i);try{for(c.s();!(t=c.n()).done;){var l,u=t.value,d=Object(g.a)(u.params.split(/[,()]/));try{for(d.s();!(l=d.n()).done;){var p=l.value;o[p]=p}}catch(h){d.e(h)}finally{d.f()}}}catch(h){c.e(h)}finally{c.f()}return delete o[""],Object.values(o)}},{key:"getDerivedStateFromProps",value:function(e,t){var s=e.lines!==t.prevLines,r=e.selectionTop!==t.prevSelectionTop||e.selectionBottom!==t.prevSelectionBottom,a=null;s&&(a={lineOffsets:n.calcOffsets(e.lines,e.lineHeight),prevLines:e.lines});var i=null;return(s||r)&&(i={pendingLineParams:n.getSelectedLineParams(e),prevSelectionTop:e.selectionTop,prevSelectionBottom:e.selectionBottom}),null!==a||null!==i?Object(c.a)(Object(c.a)({},a),i):null}}]),n}(s.PureComponent),fe=(n(433),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).handleChange=function(e){r.props.updateSearchString(e.target.value)},r.handleNext=function(e){r.props.searchNext(),r.focus(),e.preventDefault()},r.handleCancel=function(e){r.props.updateSearchString(null)},r.handleKeyDown=function(e){"Escape"===e.key&&(r.handleCancel(),e.preventDefault())},r.ref=Object(s.createRef)(),r}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.searchString||"",t=Object(H.a)("DisasmSearch__field",{"DisasmSearch__field--progress":this.props.inProgress});return Object(S.jsxs)("form",{action:"#",className:"DisasmSearch",hidden:null===this.props.searchString,onSubmit:this.handleNext,children:[Object(S.jsx)("div",{className:t,children:Object(S.jsx)("input",{type:"search",value:e,placeholder:"Find...",onChange:this.handleChange,onKeyDown:this.handleKeyDown,ref:this.ref})}),Object(S.jsx)("button",{type:"submit",children:Object(S.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"15",height:"15",role:"img",children:[Object(S.jsx)("title",{children:"Search / Next"}),Object(S.jsx)("path",{d:"M10,50 l80,0 l-35,-40 m35,40 l-35,40"})]})}),Object(S.jsx)("button",{type:"button",onClick:this.handleCancel,children:Object(S.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 180 180",width:"15",height:"15",role:"img",children:[Object(S.jsx)("title",{children:"Cancel"}),Object(S.jsx)("path",{d:"M30,30 l120,120 m-120,0 l120,-120"})]})})]})}},{key:"componentDidUpdate",value:function(e,t){null===e.searchString&&null!==this.props.searchString&&this.focus()}},{key:"focus",value:function(){this.ref.current.focus()}}]),n}(s.PureComponent)),be=(n(434),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.line;return e?Object(S.jsxs)("div",{className:"StatusBar",children:[Object(S.jsx)("div",{className:"StatusBar__left",children:this.renderLeftStatus(e)}),Object(S.jsx)("div",{className:"StatusBar__right",children:e.function||e.symbol||""})]}):Object(S.jsx)("div",{className:"StatusBar"})}},{key:"renderLeftStatus",value:function(e){if("opcode"===e.type||"macro"===e.type){if(e.dataAccess)return this.renderDataAccess(e.dataAccess);if(e.branch)return this.renderBranch(e.branch);if(e.relevantData&&"string"===typeof e.relevantData.stringValue)return this.renderString(e.relevantData)}else if("data"===e.type)return this.renderDataSymbol(e.dataSymbol,e.address);return""}},{key:"renderDataAccess",value:function(e){if(null===e.uintValue)return"Invalid address "+W(e.address);var t="["+W(e.address)+"] = ";return e.valueSymbol&&(t+=e.valueSymbol+" ("),1===e.size?t+=("00"+e.uintValue.toString(16).toUpperCase()).substr(-2):2===e.size?t+=function(e){return("0000"+e.toString(16).toUpperCase()).substr(-4)}(e.uintValue):e.size>=4&&(t+=W(e.uintValue)),e.valueSymbol&&(t+=")"),t}},{key:"renderBranch",value:function(e){var t=e.targetAddress?W(e.targetAddress):"";return e.symbol&&(t+=" = "+e.symbol),t}},{key:"renderString",value:function(e){return"["+W(e.address)+"] = "+JSON.stringify(e.stringValue)}},{key:"renderDataSymbol",value:function(e,t){var n=W(e.start);return e.label&&(n+=" ("+e.label+")"),t!==e.start&&(n+=" + "+W(e.start-t)),n}}]),n}(s.PureComponent)),me=(n(435),100),ve=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={lines:[],branchGuides:[],range:{start:0,end:0},lineHeight:0,visibleLines:0,displaySymbols:!0,wantDisplaySymbols:!0,cursor:null,searchString:null,searchInProgress:!1,highlightText:null,editingBreakpoint:null,creatingBreakpoint:null},r.jumpStack=[],r.needsScroll=!1,r.needsOffsetFix=!1,r.updatesCancel=!1,r.updatesSequence=Promise.resolve(null),r.lastSearch=null,r.updateCursor=function(e){r.state.cursor!==e&&(r.needsScroll="nearest",r.setState({cursor:e}),r.updatesSequence=r.updatesSequence.then((function(){if(r.updatesCancel)return null;var t=r.state.range,n=t.start,s=t.end,a=Math.max(me,r.state.visibleLines),i=Math.max(500,5*r.state.visibleLines);return e-4*a<n?n=e-2*a*4:e-4*i>n&&(n=e-4*(i-a)),e+4*a>s?s=e+2*a*4:e+4*i<s&&(s=e+4*(i-a)),n!==r.state.range.start||s!==r.state.range.end?r.updateDisasmNow("nearest",{address:n,end:s}):null})))},r.getSelectedLines=function(){var e=r.props,t=e.selectionTop,n=e.selectionBottom;return r.state.lines.filter((function(e){return e.address+e.addressSize>t&&e.address<=n}))},r.getSelectedDisasm=function(){var e,t=r.getSelectedLines(),n={},s=t.map((function(e){return e.branch})).filter((function(e){return e&&!e.symbol&&e.targetAddress})),a=Object(g.a)(s);try{for(a.s();!(e=a.n()).done;){var i=e.value;n[i.targetAddress]="pos_"+W(i.targetAddress)}}catch(h){a.e(h)}finally{a.f()}var o,c="",l=!0,u=Object(g.a)(t);try{for(u.s();!(o=u.n()).done;){var d=o.value,p=d.symbol||n[d.address];p&&(l||(c+="\n"),c+=p+":\n\n"),c+="\t"+d.name+" ",d.branch&&d.branch.targetAddress&&!d.branch.symbol?c+=d.params.replace(/0x[0-9A-f]+/,n[d.branch.targetAddress]):c+=d.params,c+="\n",l=!1}}catch(h){u.e(h)}finally{u.f()}return c},r.updateDisplaySymbols=function(e){r.setState({wantDisplaySymbols:e})},r.followBranch=function(e,t){if(e){var n=t.branch&&t.branch.targetAddress;null===n&&(n=t.relevantData&&t.relevantData.address),null!==n&&(r.jumpStack.push(r.state.cursor),r.gotoAddress(n))}else 0!==r.jumpStack.length?r.gotoAddress(r.jumpStack.pop()):r.gotoAddress(r.props.pc)},r.assembleInstruction=function(e,t){var n=e.address,s=prompt("Assemble instruction",t);if(!s)return Promise.resolve(null);var a=function(){return r.context.ppsspp.send({event:"memory.assemble",address:n,code:s}).then((function(){if(n===r.state.cursor){var t=r.state.lines.indexOf(e);if(t<r.state.lines.length-1){var s=r.state.lines[t+1].address;r.gotoAddress(s,"nearest")}}r.updateDisasm()}))},i=s.split(/\s*=\s*(.+)$/,2);return i.length>=2?r.context.ppsspp.send({event:"cpu.evaluate",thread:r.context.gameStatus.currentThread,expression:i[1]}).then((function(e){return r.context.ppsspp.send({event:"cpu.setReg",thread:r.context.gameStatus.currentThread,name:i[0],value:e.uintValue})})).then((function(e){var t=e.uintValue;r.context.log("Updated "+i[0]+" to "+W(t))}),a):a()},r.toggleBreakpoint=function(e,t){if(null===e.breakpoint)r.context.ppsspp.send({event:"cpu.breakpoint.add",address:e.address,enabled:!0});else if(e.breakpoint.enabled)if(t)r.context.ppsspp.send({event:"cpu.breakpoint.update",address:e.breakpoint.address||e.address,enabled:!1});else{if(null!==e.breakpoint.condition&&!window.confirm("This breakpoint has has a condition.\n\nAre you sure you want to remove it?"))return;r.context.ppsspp.send({event:"cpu.breakpoint.remove",address:e.breakpoint.address||e.address})}else r.context.ppsspp.send({event:"cpu.breakpoint.update",address:e.breakpoint.address||e.address,enabled:!0})},r.editBreakpoint=function(e){var t,n=(null===(t=e.breakpoint)||void 0===t?void 0:t.address)||e.address;r.context.ppsspp.send({event:"cpu.breakpoint.list",address:n,enabled:!0}).then((function(e){var t=e.breakpoints.find((function(e){return e.address===n}));if(t){var s=Object(c.a)(Object(c.a)({},t),{},{type:"execute"});r.setState({editingBreakpoint:s})}else{var a={address:n,type:"execute"};r.setState({creatingBreakpoint:a})}}))},r.closeEditBreakpoint=function(){r.setState({editingBreakpoint:null,creatingBreakpoint:null})},r.gotoAddress=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center";r.needsScroll=t,r.props.updateSelection({selectionTop:e,selectionBottom:e})},r.searchDisasm=function(e){var t=e&&null!==r.lastSearch,n=r.state,s=n.cursor,a=n.searchString;if(t||a){if(r.state.searchInProgress){if(t)return;r.searchCancel()}t||(r.lastSearch={match:a,end:s,last:null});var i={cancel:!1};r.lastSearch.cancelState=i,r.setState({searchInProgress:!0});var o=r.lastSearch,c=o.match,l=o.end,u=o.last;r.context.ppsspp.send({event:"memory.searchDisasm",address:s===u?s+4:s,end:l,match:c}).then((function(e){var t=e.address;i.cancel||(r.lastSearch&&(r.lastSearch.last=t),null!==t?r.gotoAddress(t):s!==l?(window.alert("Reached the starting point of the search"),r.gotoAddress(l)):window.alert("The specified text was not found:\n\n"+c))})).finally((function(){i.cancel||(r.setState({searchInProgress:!1}),r.lastSearch&&(r.lastSearch.cancelState=null))}))}else r.searchPrompt()},r.updateSearchString=function(e){var t=e?e.toLowerCase():null;r.setState({highlightText:t,searchString:e}),r.lastSearch&&r.lastSearch.match!==e&&(r.searchCancel(),r.lastSearch=null),null===e&&r.listRef.current&&r.listRef.current.ensureCursorInView(!1)},r.searchPrompt=function(){r.updateSearchString(r.state.searchString||(r.lastSearch?r.lastSearch.match:"")),r.searchRef.current.focus()},r.searchNext=function(){r.searchDisasm(!0)},r.searchCancel=function(){r.lastSearch&&r.lastSearch.cancelState&&(r.lastSearch.cancelState.cancel=!0,r.setState({searchInProgress:!1}),r.lastSearch.cancelState=null)},r.onDoubleClick=function(e,t){r.toggleBreakpoint(t.line)},r.applyScroll=function(e){r.ref.current.scrollTop+=e*r.state.lineHeight},r.ref=Object(s.createRef)(),r.listRef=Object(s.createRef)(),r.searchRef=Object(s.createRef)(),r}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t={onScroll:function(t){return e.onScroll(t)},onDragStart:function(e){return e.preventDefault()}};return this.context.gameStatus.started?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",Object(c.a)(Object(c.a)({ref:this.ref,className:"Disasm"},t),{},{children:Object(S.jsx)(he,Object(c.a)(Object(c.a)({ref:this.listRef},this.state),{},{onDoubleClick:this.onDoubleClick,updateSelection:this.props.updateSelection,promptGoto:this.props.promptGoto,updateCursor:this.updateCursor,updateDisplaySymbols:this.updateDisplaySymbols,selectionTop:this.props.selectionTop,selectionBottom:this.props.selectionBottom,getSelectedDisasm:this.getSelectedDisasm,followBranch:this.followBranch,assembleInstruction:this.assembleInstruction,toggleBreakpoint:this.toggleBreakpoint,editBreakpoint:this.editBreakpoint,applyScroll:this.applyScroll,searchPrompt:this.searchPrompt,searchNext:this.searchNext}))})),Object(S.jsx)(be,{line:this.state.lines.find((function(t){return t.address===e.state.cursor}))}),this.renderContextMenu(),Object(S.jsx)(fe,{ref:this.searchRef,searchString:this.state.searchString,searchNext:this.searchNext,updateSearchString:this.updateSearchString,inProgress:this.state.searchInProgress}),Object(S.jsx)($,{isOpen:null!==this.state.editingBreakpoint||null!==this.state.creatingBreakpoint,onClose:this.closeEditBreakpoint,breakpoint:this.state.editingBreakpoint,initialOverrides:this.state.creatingBreakpoint})]}):this.renderNotStarted()}},{key:"renderNotStarted",value:function(){return Object(S.jsx)("div",{className:"Disasm--not-started",children:"Waiting for a game to start..."})}},{key:"renderContextMenu",value:function(){return Object(S.jsx)(le,{getSelectedLines:this.getSelectedLines,getSelectedDisasm:this.getSelectedDisasm,followBranch:this.followBranch,assembleInstruction:this.assembleInstruction,toggleBreakpoint:this.toggleBreakpoint})}},{key:"getSnapshotBeforeUpdate",value:function(e,t){if(this.needsOffsetFix&&this.listRef.current&&0!==this.state.lines.length){var n=this.state.lines,s=n[Math.floor(n.length/2)].address,r=this.listRef.current.addressBoundingTop(s);if(r)return{top:r,centerAddress:s}}return null}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=k.listen({connection:function(){e.context.gameStatus.started&&e.updateDisasm("center")},"cpu.stepping":function(){var t=0!==e.state.range.start||0!==e.state.range.end;e.updateDisasm(t?"nearest":"center")},"cpu.setReg":function(t){0===t.category&&32===t.register&&e.updateDisasm("center")},"cpu.breakpoint.add":function(){e.updateDisasm()},"cpu.breakpoint.update":function(){e.updateDisasm()},"cpu.breakpoint.remove":function(){e.updateDisasm()}}),this.updatesCancel=!1}},{key:"componentWillUnmount",value:function(){this.searchCancel(),this.updatesCancel=!0,k.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t,n){var s=this,r=this.props,a=r.selectionTop,i=r.selectionBottom,o=this.state,c=o.range,l=o.lineHeight,u=null,d=null;if(this.state.wantDisplaySymbols!==t.wantDisplaySymbols&&(u=!1),this.props.currentThread!==e.currentThread&&(u=!1),a===e.selectionTop&&i===e.selectionBottom||(a<c.start||i>=c.end)&&(u="center",d=!0),u||e.setInitialPC||!this.props.setInitialPC||(u="center",d=!0),null!==u&&this.props.setInitialPC&&this.updateDisasm(u,d),0===l){var p=document.querySelector(".DisasmLine");p&&setTimeout((function(){return s.setState({lineHeight:p.getBoundingClientRect().height})}),0)}else if(this.ref.current){var h=Math.floor(this.ref.current.clientHeight/l);h!==this.state.visibleLines&&this.setState({visibleLines:h})}if(this.props.jumpMarker!==e.jumpMarker&&(this.needsScroll="center"),this.needsScroll&&this.listRef.current){var f=this.listRef.current;setTimeout((function(){f.ensureCursorInView(s.needsScroll),s.needsScroll=!1}),0)}if(n&&this.listRef.current){var b=this.listRef.current.addressBoundingTop(n.centerAddress);this.ref.current.scrollTop-=n.top-b,this.needsOffsetFix=!1}}},{key:"updateDisasm",value:function(e,t){var n=this;this.updatesSequence=this.updatesSequence.then((function(){return n.updatesCancel?null:n.updateDisasmNow(e,t)}))}},{key:"updateDisasmNow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.props.setInitialPC)return Promise.resolve(null);var s=this.state,r=s.range,a=s.visibleLines,i=s.wantDisplaySymbols,o=n;if(!0===n||null===n&&0===r.start&&0===r.end){var l=Math.max(me,a),u=Math.floor(1.5*l);o={address:this.props.selectionTop-4*u,count:2*u}}else null===n&&(o={address:r.start,end:r.end});return Promise.resolve(null).then((function(){return t.context.ppsspp.send(Object(c.a)(Object(c.a)({event:"memory.disasm",thread:t.context.gameStatus.currentThread},o),{},{displaySymbols:i})).then((function(n){if(!t.updatesCancel){var s=n.range,r=n.branchGuides,a=n.lines;e?t.needsScroll=e:t.needsOffsetFix=!0,t.setState({range:s,branchGuides:t.cleanupBranchGuides(r),lines:a,displaySymbols:i})}}),(function(e){t.updatesCancel||t.setState({range:{start:0,end:0},branchGuides:[],lines:[]})}))}))}},{key:"cleanupBranchGuides",value:function(e){var t=new Map;return e.forEach((function(e){var n=String(e.top)+String(e.bottom)+e.direction;t.set(n,e)})),Object(m.a)(t.values())}},{key:"onScroll",value:function(e){var t=this;this.updatesSequence=this.updatesSequence.then((function(){if(t.updatesCancel)return null;var e=t.bufferRange(),n=e.bufferTop,s=e.bufferBottom,r=Math.max(me,t.state.visibleLines),a=Math.max(500,5*t.state.visibleLines),i=t.state.range,o=i.start,c=i.end;return n<r?o-=4*r:n>a&&(o+=4*Math.max(r,n-a)),s<r?c+=4*r:s>a&&(c-=4*Math.max(r,s-a)),o!==t.state.range.start||c!==t.state.range.end?t.updateDisasmNow(!1,{address:o,end:c}):null}))}},{key:"bufferRange",value:function(){var e=this.ref.current,t=e.scrollHeight,n=e.scrollTop,s=e.clientHeight,r=n/this.state.lineHeight,a=(t-n-s)/this.state.lineHeight,i=Math.floor((this.state.visibleLines-1)/2);return{bufferTop:r+i,bufferBottom:a+i}}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.selectionTop,s=e.selectionBottom;if(t.cursor<n||t.cursor>s){var r=n;if(t.lines.length){var a=t.lines.find((function(e){return e.address<=n&&e.address+e.addressSize>n}));r=a?a.address:r}return{cursor:r}}return null}}]),n}(s.PureComponent);ve.contextType=w;var ge=ve,je=(n(436),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={breakpointModalOpen:!1,connected:!1,lastThread:"",threads:[]},e.handleGoBreak=function(){e.context.gameStatus.stepping&&e.props.updateCurrentThread(void 0),e.context.ppsspp.send({event:e.context.gameStatus.stepping?"cpu.resume":"cpu.stepping"}).catch((function(){}))},e.handleStepInto=function(){e.props.updateCurrentThread(void 0),e.context.ppsspp.send({event:"cpu.stepInto",thread:e.context.gameStatus.currentThread}).catch((function(){}))},e.handleStepOver=function(){e.props.updateCurrentThread(void 0),e.context.ppsspp.send({event:"cpu.stepOver",thread:e.context.gameStatus.currentThread}).catch((function(){}))},e.handleStepOut=function(){var t=e.context.gameStatus.currentThread;e.props.updateCurrentThread(void 0),e.context.ppsspp.send({event:"cpu.stepOut",thread:e.context.gameStatus.currentThread}).catch((function(){e.props.updateCurrentThread(t)}))},e.handleNextHLE=function(){e.props.updateCurrentThread(void 0),e.context.ppsspp.send({event:"cpu.nextHLE"}).catch((function(){}))},e.handleThreadSelect=function(t){var n=e.state.threads.find((function(e){return e.id===Number(t.target.value)}));n&&e.props.updateCurrentThread(n.id,n.pc)},e.handleBreakpointOpen=function(){e.setState({breakpointModalOpen:!0})},e.handleBreakpointClose=function(){e.setState({breakpointModalOpen:!1})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.context.gameStatus,t=e.started,n=e.paused,s=e.stepping,r=!t||!s||n;return Object(S.jsxs)("div",{className:"DisasmButtons",children:[Object(S.jsxs)("div",{className:"DisasmButtons__group DisasmButtons__nav",children:[Object(S.jsx)("button",{type:"button",onClick:this.props.showNavTray,children:"Nav"}),Object(S.jsx)("span",{className:"DisasmButtons__spacer"})]}),Object(S.jsxs)("div",{className:"DisasmButtons__group",children:[Object(S.jsx)("button",{type:"button",disabled:!t||n,onClick:this.handleGoBreak,children:s||!t?"Go":"Break"}),Object(S.jsx)("span",{className:"DisasmButtons__spacer"})]}),Object(S.jsxs)("div",{className:"DisasmButtons__group",children:[Object(S.jsx)("button",{type:"button",disabled:r,onClick:this.handleStepInto,children:"Step Into"}),Object(S.jsx)("button",{type:"button",disabled:r,onClick:this.handleStepOver,children:"Step Over"}),Object(S.jsx)("button",{type:"button",disabled:r,onClick:this.handleStepOut,children:"Step Out"}),Object(S.jsx)("span",{className:"DisasmButtons__spacer"})]}),Object(S.jsxs)("div",{className:"DisasmButtons__group",children:[Object(S.jsx)("button",{type:"button",disabled:r,onClick:this.handleNextHLE,children:"Next HLE"}),Object(S.jsx)("span",{className:"DisasmButtons__spacer"})]}),Object(S.jsxs)("div",{className:"DisasmButtons__group",children:[Object(S.jsx)("button",{type:"button",onClick:this.handleBreakpointOpen,disabled:!t,children:"Breakpoint"}),Object(S.jsx)("span",{className:"DisasmButtons__spacer"})]}),Object(S.jsx)("div",{className:"DisasmButtons__group",children:Object(S.jsxs)("span",{className:"DisasmButtons__thread-list",children:["Thread: ",this.renderThreadList()]})}),Object(S.jsx)($,{isOpen:this.state.breakpointModalOpen,onClose:this.handleBreakpointClose})]})}},{key:"renderThreadList",value:function(){var e=this;return 0===this.state.threads.length?"(none)":Object(S.jsx)("select",{onChange:this.handleThreadSelect,value:this.context.gameStatus.currentThread||this.state.lastThread,children:this.state.threads.map((function(t){return e.renderThread(t)}))})}},{key:"renderThread",value:function(e){var t="DisasmButtons__thread"+(e.isCurrent?" DisasmButtons__thread--current":"");return Object(S.jsxs)("option",{value:e.id,className:t,children:[e.name,e.isCurrent?" (current)":""]},e.id)}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=k.listen({"connection.change":function(t){return e.setState({connected:t})},"cpu.stepping":function(){return e.updateThreadList(!0)}})}},{key:"componentWillUnmount",value:function(){k.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t){!t.connected&&this.state.connected&&this.updateThreadList(void 0===this.context.gameStatus.currentThread)}},{key:"updateThreadList",value:function(e){var t=this;this.state.connected&&this.context.ppsspp.send({event:"hle.thread.list"}).then((function(n){var s=n.threads;if(t.setState({threads:s}),e){var r=s.find((function(e){return e.isCurrent}));r&&r.id!==t.context.gameStatus.currentThread&&t.props.updateCurrentThread(r.id)}}),(function(){t.setState({threads:[]})}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=null;return e.currentThread&&e.currentThread!==t.lastThread&&(n=Object(c.a)(Object(c.a)({},n),{},{lastThread:e.currentThread||""})),(e.stepping||e.started)&&(n=Object(c.a)(Object(c.a)({},n),{},{connected:!0})),!e.started&&t.threads.length&&(n=Object(c.a)(Object(c.a)({},n),{},{threads:[]})),n}}]),n}(s.PureComponent));je.contextType=w;var Oe=je,ye=(n(437),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={address:""},r.handleChange=function(e){r.setState({address:e.target.value})},r.handleSubmit=function(e){r.context.gameStatus.started&&r.context.ppsspp.send({event:"cpu.evaluate",thread:r.context.gameStatus.currentThread,expression:r.state.address}).then((function(e){var t=e.uintValue;r.context.gameStatus.started&&r.props.gotoAddress(t)}),(function(e){r.ref.current.focus(),r.ref.current.select()})),e.preventDefault()},r.handlePC=function(e){r.jumpToReg("pc")},r.handleRA=function(e){r.jumpToReg("ra")},r.ref=Object(s.createRef)(),r.id="GotoBox__address--"+Math.random().toString(36).substr(2,9),r}return Object(u.a)(n,[{key:"render",value:function(){return Object(S.jsxs)("form",{action:"#",className:"GotoBox",onSubmit:this.handleSubmit,children:[Object(S.jsx)("label",{className:"GotoBox__label",htmlFor:this.id,children:"Go to:"}),Object(S.jsx)("input",{ref:this.ref,type:"text",id:this.id,className:"GotoBox__address",value:this.state.address,onChange:this.handleChange,title:"Hexadecimal address or expression, enter to submit",autoComplete:"off"}),this.renderPCButtons()]})}},{key:"renderPCButtons",value:function(){if(!this.includePC)return null;var e=!this.context.gameStatus.started;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("button",{type:"button",className:"GotoBox__button",onClick:this.handlePC,disabled:e,children:"PC"}),Object(S.jsx)("button",{type:"button",className:"GotoBox__button",onClick:this.handleRA,disabled:e,children:"RA"})]})}},{key:"componentDidUpdate",value:function(e,t){this.props.promptGotoMarker!==e.promptGotoMarker&&(this.ref.current.focus(),this.ref.current.select())}},{key:"jumpToReg",value:function(e){var t=this;this.context.ppsspp.send({event:"cpu.getReg",name:e}).then((function(e){t.context.gameStatus.started&&t.props.gotoAddress(e.uintValue)}))}}]),n}(s.PureComponent));ye.contextType=w;var ke=ye,xe=n(171),Se=(n(447),n(448),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={connected:!1,loading:!0,rowHeight:null,functions:[],filter:"",filteredFunctions:[]},e.renderSizedList=function(t){var n=t.height,s=t.width,r=e.state,a=r.filter,i=r.filteredFunctions,o=r.rowHeight;return Object(S.jsx)(xe.b,{height:n,rowHeight:o,rowRenderer:e.renderFunc,width:s,rowCount:i.length,filter:a})},e.renderFunc=function(t){var n=t.index,s=t.key,r=t.style,a=e.state.filteredFunctions[n];return Object(S.jsx)("div",{style:r,children:Object(S.jsx)("button",{type:"button","data-address":a.address,children:a.name})},s+"-"+a.address)},e.handleFilter=function(t){var n=t.target.value;e.setState((function(t){return{filter:n,filteredFunctions:e.applyFilter(t.functions,n)}}))},e.handleClick=function(t){var n=t.target.dataset.address;e.props.gotoDisasm(Number(n)),t.preventDefault()},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state.filter;return Object(S.jsxs)("div",{className:"FuncList",children:[Object(S.jsx)("input",{type:"search",className:"FuncList__search",value:e,onChange:this.handleFilter}),this.renderList()]})}},{key:"renderList",value:function(){var e=this.state,t=e.filter,n=e.loading,s=e.rowHeight;return n||!s?Object(S.jsx)("div",{className:"FuncList__loading",children:"Loading..."}):Object(S.jsx)("div",{className:"FuncList__listing",onClick:this.handleClick,children:Object(S.jsx)(xe.a,{filter:t,children:this.renderSizedList})})}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=k.listen({"connection.change":function(t){return e.setState({connected:t})},"game.start":function(){return e.updateList()}}),this.state.connected&&this.updateList(),this.state.rowHeight||setTimeout((function(){return e.measureHeight()}),0)}},{key:"componentWillUnmount",value:function(){k.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t){var n=this;!t.connected&&this.state.connected&&this.updateList(),this.state.rowHeight||setTimeout((function(){return n.measureHeight()}),0)}},{key:"measureHeight",value:function(){var e=document.querySelector(".FuncList__loading");if(e){var t=e.getBoundingClientRect().height;this.setState({rowHeight:t})}}},{key:"updateList",value:function(){var e=this;this.state.connected&&(this.state.loading||0!==this.state.functions.length||this.setState({loading:!0}),this.context.ppsspp.send({event:"hle.func.list"}).then((function(t){var n=t.functions;n.sort((function(e,t){return e.name.localeCompare(t.name)})),e.setState((function(t){return{functions:n,filteredFunctions:e.applyFilter(n,t.filter),loading:!1}}))}),(function(){e.setState({functions:[],filteredFunctions:[],loading:!1})})))}},{key:"applyFilter",value:function(e,t){if(""===t)return e;var n=t.toLowerCase();return e.filter((function(e){return-1!==e.name.toLowerCase().indexOf(n)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=null;return e.started&&(n=Object(c.a)(Object(c.a)({},n),{},{connected:!0})),!e.started&&t.functions.length&&(n=Object(c.a)(Object(c.a)({},n),{},{functions:[],filteredFunctions:[]})),n}}]),n}(s.PureComponent));Se.contextType=w;var Ce=Se,_e=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={cursor:0},r.needsScroll=!1,r.onDoubleClick=function(e,t){0===e.button&&r.props.onDoubleClick(e,t)},r.cursorRef=Object(s.createRef)(),r}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return Object(S.jsx)("dl",{children:this.props.registerNames.map((function(t,n){return e.renderReg(t,n)}))})}},{key:"renderReg",value:function(e,t){var n=this,s=function(e){return{cat:n.props.id,reg:t,value:n.format(t)}},r={onDoubleClick:function(e){return n.onDoubleClick(e,s())},onMouseDown:function(e){return n.setState({cursor:t})},onKeyDown:function(e){return n.onKeyDown(e)},tabIndex:0},a={"RegPanel__item--changed":this.changed(t),"RegPanel__item--selected":this.state.cursor===t},i=this.state.cursor===t?this.cursorRef:void 0;return Object(S.jsxs)(P.b,{id:this.props.contextmenu,renderTag:"a",attributes:r,collect:s,holdToDisplay:-1,children:[Object(S.jsx)("dt",{children:e}),Object(S.jsx)("dd",{className:Object(H.a)(a),ref:i,children:this.format(t)})]},t)}},{key:"format",value:function(e){return 0===this.props.id?W(this.props.uintValues[e]):this.props.floatValues[e]}},{key:"changed",value:function(e){return this.props.uintValues[e]!==this.props.uintValuesLast[e]}},{key:"componentDidUpdate",value:function(e,t){if(this.needsScroll&&this.cursorRef.current){var n=this.cursorRef.current.parentNode;B(n,{block:"nearest"}),n.focus(),this.needsScroll=!1}}},{key:"onKeyDown",value:function(e){R()||("ArrowUp"===e.key&&this.state.cursor>0&&(this.needsScroll=!0,this.setState((function(e){return{cursor:e.cursor-1}})),e.preventDefault()),"ArrowDown"===e.key&&this.state.cursor<this.props.registerNames.length-1&&(this.needsScroll=!0,this.setState((function(e){return{cursor:e.cursor+1}})),e.preventDefault()))}}]),n}(s.PureComponent),we=(n(449),n(450),n(387),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={categories:[]},e.handleViewMemory=function(e,t){console.log(t)},e.handleViewDisassembly=function(t,n){var s=e.state.categories[n.cat].uintValues[n.reg];e.props.gotoDisasm(s)},e.handleCopyReg=function(e,t,n){ie(t.value)},e.handleChangeReg=function(t,n,s){var r=(0===n.cat?"0x":"")+n.value,a=e.state.categories[n.cat].registerNames[n.reg],i=window.prompt("New value for "+a,r);if(null!==i){var o={event:"cpu.setReg",thread:e.context.gameStatus.currentThread,category:n.cat,register:n.reg,value:i};e.context.ppsspp.send(o).catch((function(e){window.alert(e)}))}},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(S.jsxs)("div",{id:"RegPanel",children:[this.renderTabs(),this.renderContextMenu()]})}},{key:"renderTabs",value:function(){var e=this,t=this.state.categories;return 0===t.length?"":Object(S.jsxs)(b.d,{children:[Object(S.jsx)(b.b,{children:t.map((function(e){return Object(S.jsx)(b.a,{children:e.name},e.id)}))}),t.map((function(t){return Object(S.jsx)(b.c,{children:Object(S.jsx)(_e,Object(c.a)({contextmenu:"reglist",onDoubleClick:e.handleChangeReg},t))},t.id)}))]})}},{key:"renderContextMenu",value:function(){var e=!this.context.gameStatus.stepping;return Object(S.jsxs)(P.a,{id:"reglist",children:[Object(S.jsx)(P.c,{onClick:this.handleViewMemory,children:"Go to in Memory View"}),Object(S.jsx)(P.c,{onClick:this.handleViewDisassembly,children:"Go to in Disassembly"}),Object(S.jsx)(P.c,{divider:!0}),Object(S.jsx)(P.c,{onClick:this.handleCopyReg,children:"Copy Value"}),Object(S.jsx)(P.c,{disabled:e,onClick:this.handleChangeReg,children:"Change..."})]})}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=k.listen({connection:function(){return e.updateRegs(!1)},"cpu.stepping":function(){return e.updateRegs(!1)},"cpu.setReg":function(t){return e.updateReg(t)}})}},{key:"componentWillUnmount",value:function(){k.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t){this.props.currentThread&&this.props.currentThread!==e.currentThread&&this.updateRegs(!0)}},{key:"updateRegs",value:function(e){var t=this;this.context.ppsspp.send({event:"cpu.getAllRegs",thread:this.context.gameStatus.currentThread}).then((function(n){var s,r=n.categories,a=0!==t.state.categories.length,i=Object(g.a)(r);try{for(i.s();!(s=i.n()).done;){var o=s.value,c=a?t.state.categories[o.id]:null;o.uintValuesLast=a?e?c.uintValuesLast:c.uintValues:o.uintValues,o.floatValuesLast=a?e?c.floatValuesLast:c.floatValues:o.floatValues}}catch(l){i.e(l)}finally{i.f()}t.setState({categories:r})}),(function(e){console.error(e)}))}},{key:"updateReg",value:function(e){var t=function(e,t,n){return e.slice(0,t).concat([n]).concat(e.slice(t+1))};this.setState((function(n){return{categories:n.categories.map((function(n){return n.id===e.category?Object(c.a)(Object(c.a)({},n),{},{uintValuesLast:n.uintValuesLast,floatValuesLast:n.floatValuesLast,uintValues:t(n.uintValues,e.register,e.uintValue),floatValues:t(n.floatValues,e.register,e.floatValue)}):n}))}}))}}]),n}(s.PureComponent));we.contextType=w;var De=we,Te=(n(451),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={categories:[],format:"float"},e.handleFormat=function(t){var n=t.target.value;e.setState({format:n})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state,t=e.categories,n=e.format;if(t.length<3)return null;for(var s=[],r=0;r<t[2].uintValues.length/16;++r)s.push(this.renderMatrix(r));return Object(S.jsxs)(M,{contentLabel:"VFPU",isOpen:this.props.isOpen,onClose:this.props.onClose,children:[Object(S.jsx)("h2",{children:"VFPU Registers"}),Object(S.jsx)("div",{className:"VisualizeVFPU__list",children:s}),Object(S.jsxs)("div",{className:"VisualizeVFPU__format",children:["Display as:",Object(S.jsxs)("label",{children:[Object(S.jsx)("input",{type:"radio",checked:"float"===n,value:"float",onChange:this.handleFormat})," Float"]}),Object(S.jsxs)("label",{children:[Object(S.jsx)("input",{type:"radio",checked:"uint"===n,value:"uint",onChange:this.handleFormat})," Hex"]})]})]})}},{key:"renderMatrix",value:function(e){return Object(S.jsxs)("table",{className:"VisualizeVFPU__matrix",children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsxs)("th",{className:"VisualizeVFPU__name",children:["M",e,"00"]}),Object(S.jsxs)("th",{className:"VisualizeVFPU__row-header",children:["R",e,"00"]}),Object(S.jsxs)("th",{className:"VisualizeVFPU__row-header",children:["R",e,"01"]}),Object(S.jsxs)("th",{className:"VisualizeVFPU__row-header",children:["R",e,"02"]}),Object(S.jsxs)("th",{className:"VisualizeVFPU__row-header",children:["R",e,"03"]})]})}),Object(S.jsxs)("tbody",{children:[this.renderColumn(e,0),this.renderColumn(e,1),this.renderColumn(e,2),this.renderColumn(e,3)]})]},e)}},{key:"renderColumn",value:function(e,t){return Object(S.jsxs)("tr",{children:[Object(S.jsxs)("th",{className:"VisualizeVFPU__col-header",children:["C",e,t,"0"]}),Object(S.jsx)("td",{children:this.renderValue(e,t,0)}),Object(S.jsx)("td",{children:this.renderValue(e,t,1)}),Object(S.jsx)("td",{children:this.renderValue(e,t,2)}),Object(S.jsx)("td",{children:this.renderValue(e,t,3)})]},t)}},{key:"renderValue",value:function(e,t,n){var s=4*e+32*t+n,r=this.state.categories[2];return"uint"===this.state.format?W(r.uintValues[s]):r.floatValues[s]}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=k.listen({"cpu.getAllRegs":function(t){var n=t.categories;return e.setState({categories:n})}})}},{key:"componentWillUnmount",value:function(){k.forget(this.listeners_)}}]),n}(s.PureComponent)),Pe=(n(452),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={vfpuModalOpen:!1,everShownFuncs:!1},e.handleSelect=function(t){1!==t||e.state.everShownFuncs||e.setState({everShownFuncs:!0})},e.handleVFPUOpen=function(){e.setState({vfpuModalOpen:!0})},e.handleVFPUClose=function(){e.setState({vfpuModalOpen:!1})},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(S.jsxs)("div",{className:"LeftPanel",children:[Object(S.jsxs)(b.d,{onSelect:this.handleSelect,children:[Object(S.jsxs)(b.b,{children:[Object(S.jsx)(b.a,{children:"Regs"}),Object(S.jsx)(b.a,{children:"Funcs"}),Object(S.jsx)(b.a,{children:"Tools"})]}),Object(S.jsx)(b.c,{forceRender:!0,children:Object(S.jsx)(De,{gotoDisasm:this.props.gotoDisasm,currentThread:this.context.gameStatus.currentThread})}),Object(S.jsx)(b.c,{forceRender:this.state.everShownFuncs,children:Object(S.jsx)(Ce,{gotoDisasm:this.props.gotoDisasm,started:this.context.gameStatus.started})}),Object(S.jsx)(b.c,{className:"react-tabs__tab-panel LeftPanel__tools",children:Object(S.jsx)("button",{type:"button",onClick:this.handleVFPUOpen,children:"Visualize VFPU"})})]}),Object(S.jsx)(Te,{isOpen:this.state.vfpuModalOpen,onClose:this.handleVFPUClose})]})}}]),n}(s.PureComponent));Pe.contextType=w;var Ne=Pe,Be=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return"log"===this.props.item.event?this.formatLogEvent():this.renderInternal()}},{key:"renderInternal",value:function(){return Object(S.jsx)("span",{className:this.makeClassName(),children:this.props.item.message})}},{key:"formatLogEvent",value:function(){var e=this.props.item;return Object(S.jsxs)("span",{className:this.makeClassName(),children:[Object(S.jsxs)("span",{className:"Log__message__header",children:[Object(S.jsx)("span",{className:"Log__message__timestamp",children:e.timestamp})," "+e.header+" "]}),e.message]})}},{key:"makeClassName",value:function(){var e,t=this.props.item;return Object(H.a)("Log__message",(e={"Log__message--internal":"log"!==t.event},Object(V.a)(e,"Log__message--channel-"+t.channel,"log"===t.event),Object(V.a)(e,"Log__message--level-"+t.level,!0),e))}}]),n}(s.PureComponent),Le=new(function(){function e(){Object(l.a)(this,e),this.id_=0,this.items_=[],this.changeListeners_=[]}return Object(u.a)(e,[{key:"init",value:function(e){var t=this;e.onError=function(e,n){var s={message:e+"\n",level:n};t.addLogItem(s)},k.listen({log:this.onLogEvent.bind(this)})}},{key:"onLogEvent",value:function(e){var t=Object(c.a)({},e);this.addLogItem(t)}},{key:"addLogItem",value:function(e){var t=++this.id_,n=Object(c.a)({id:t},e);this.items_=this.items_.concat([n]).slice(-5e3);var s,r=Object(g.a)(this.changeListeners_);try{for(r.s();!(s=r.n()).done;){(0,s.value)(this.items_)}}catch(a){r.e(a)}finally{r.f()}}},{key:"listen",value:function(e){this.changeListeners_.includes(e)||(this.changeListeners_.push(e),e(this.items_))}},{key:"forget",value:function(e){this.changeListeners_=this.changeListeners_.filter((function(t){return t!==e}))}}]),e}()),Re=Le;n(453);function Me(e){var t=function(){var e=Object(s.useState)([]),t=Object(v.a)(e,2),n=t[0],r=t[1];return Object(s.useEffect)((function(){function e(e){r(e)}return Le.listen(e),function(){return Le.forget(e)}}),[]),n}(),n=Object(s.useRef)();return Object(s.useEffect)((function(){var e=n.current;e.scrollTop=e.scrollHeight-e.clientHeight}),[n,t]),Object(S.jsx)("div",{id:"Log",ref:n,children:t.map((function(e){return Object(S.jsx)(Be,{item:e},e.id)}))})}n(454);var Ae=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={setInitialPC:!1,selectionTop:null,selectionBottom:null,jumpMarker:null,promptGotoMarker:null,lastTicks:0,ticks:0,navTray:!1},e.updateSelection=function(t){e.setState(t)},e.gotoDisasm=function(t){e.setState({selectionTop:t,selectionBottom:t,jumpMarker:{}})},e.promptGoto=function(){e.setState({promptGotoMarker:{}})},e.updateCurrentThread=function(t,n){e.setState({setInitialPC:0!==n&&void 0!==n}),e.context.gameStatus.setState({currentThread:t}),0!==n&&void 0!==n&&(e.context.gameStatus.setState({pc:n}),e.gotoDisasm(n))},e.showNavTray=function(){e.setState({navTray:!0})},e.hideNavTray=function(){e.setState({navTray:!1})},e.updateInitialPC=function(){e.context.ppsspp.send({event:"cpu.getReg",name:"pc"}).then((function(t){var n=t.uintValue;e.state.setInitialPC||e.gotoDisasm(n),e.setState({setInitialPC:0!==n}),e.context.gameStatus.setState({pc:n})}))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.context.gameStatus,t=e.pc,n=e.currentThread,s=this.state,r=s.selectionTop,a=s.selectionBottom,i=s.jumpMarker,o=s.setInitialPC,c=s.navTray,l={currentThread:n,selectionTop:r,selectionBottom:a,jumpMarker:i,pc:t,setInitialPC:o};return Object(S.jsxs)("div",{id:"CPU",children:[this.renderMain(c,l),this.renderUtilityPanel()]})}},{key:"renderMain",value:function(e,t){var n=this.context.gameStatus,s=n.stepping,r=n.paused,a=n.started,i=n.currentThread;return Object(S.jsxs)("div",{className:"CPU__main",children:[Object(S.jsxs)("div",{className:e?"CPU__pane CPU__pane--open":"CPU__pane",children:[Object(S.jsx)("button",{type:"button",onClick:this.hideNavTray,className:"CPU__paneClose",children:"Close"}),Object(S.jsx)(ke,{gotoAddress:this.gotoDisasm,includePC:!0,promptGotoMarker:this.state.promptGotoMarker}),Object(S.jsx)(Ne,{gotoDisasm:this.gotoDisasm})]}),Object(S.jsxs)("div",{className:"Disasm__container",children:[Object(S.jsx)(Oe,{stepping:s&&!r,started:a,currentThread:i,updateCurrentThread:this.updateCurrentThread,showNavTray:this.showNavTray}),Object(S.jsx)(ge,Object(c.a)(Object(c.a)({},t),{},{updateSelection:this.updateSelection,promptGoto:this.promptGoto}))]})]})}},{key:"renderUtilityPanel",value:function(){return Object(S.jsx)("div",{className:"CPU__utilityPanel App-utilityPanel",children:Object(S.jsxs)(b.d,{onSelect:this.handleSelect,children:[Object(S.jsxs)(b.b,{children:[Object(S.jsx)(b.a,{children:"Log"}),Object(S.jsx)(b.a,{children:"Breakpoints"})]}),Object(S.jsx)(b.c,{forceRender:!0,children:Object(S.jsx)(Me,{})}),Object(S.jsx)(b.c,{children:Object(S.jsx)(ne,{gotoDisasm:this.gotoDisasm})})]})})}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=k.listen({connection:function(){return e.onConnection()},"cpu.stepping":function(t){return e.onStepping(t)},"game.start":function(){e.state.setInitialPC||e.updateInitialPC()},"game.quit":function(){e.setState({setInitialPC:!1})},"cpu.setReg":function(t){if(0===t.category&&32===t.register){var n=t.uintValue;e.state.setInitialPC||e.gotoDisasm(n),e.setState({setInitialPC:0!==n})}},"cpu.getAllRegs":function(t){var n=t.categories[0].uintValues[32];e.state.setInitialPC||e.gotoDisasm(n),e.setState({setInitialPC:0!==n})}})}},{key:"componentWillUnmount",value:function(){k.forget(this.listeners_)}},{key:"onConnection",value:function(){var e=this;this.context.ppsspp.send({event:"cpu.status"}).then((function(t){var n=t.pc,s=t.ticks;e.state.setInitialPC||e.gotoDisasm(n),e.setState({setInitialPC:0!==n,ticks:s,lastTicks:s})}))}},{key:"onStepping",value:function(e){this.setState((function(t){return{selectionTop:e.pc,selectionBottom:e.pc,lastTicks:t.ticks,ticks:e.ticks}}))}}]),n}(s.PureComponent);Ae.contextType=w;var Ve=Ae,Fe=(n(455),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={connected:!1,started:!1,paused:!0,recording:!1},e.beginRecord=function(t){e.setState({recording:!0}),e.context.ppsspp.send({event:"gpu.record.dump"}).then((function(t){var n=document.createElement("a");n.setAttribute("download","recording.ppdmp"),n.href=t.uri,n.hidden=!0,document.body.appendChild(n),n.click(),document.body.removeChild(n),e.setState({recording:!1})})),t.preventDefault()},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(S.jsxs)("div",{id:"GPU",children:[this.renderMain(),this.renderUtilityPanel()]})}},{key:"renderMain",value:function(){return Object(S.jsxs)("div",{className:"GPU__main",children:[Object(S.jsx)("div",{className:"GPU__info",children:this.state.started&&!this.state.paused?"Click below to generate a GE dump.  It will download as a file.":"Waiting for a game to start..."}),this.state.started&&!this.state.paused?Object(S.jsx)("form",{className:"GPU__form",onSubmit:this.beginRecord,children:Object(S.jsx)("button",{type:"submit",disabled:this.state.recording,children:this.state.recording?"Recording...":"Record"})}):null]})}},{key:"renderUtilityPanel",value:function(){return Object(S.jsx)("div",{className:"GPU__utilityPanel App-utilityPanel",children:Object(S.jsx)(Me,{})})}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=k.listen({connection:function(){return e.onConnection()},"connection.change":function(t){return e.onConnectionChange(t)},"game.start":function(){return e.setState({started:!0,paused:!1})},"game.quit":function(){return e.setState({started:!1,paused:!0})},"game.pause":function(){return e.setState({paused:!0})},"game.resume":function(){return e.setState({paused:!1})}})}},{key:"componentWillUnmount",value:function(){k.forget(this.listeners_)}},{key:"onConnectionChange",value:function(e){this.setState({connected:e,started:!1,paused:!0})}},{key:"onConnection",value:function(){var e=this;this.context.ppsspp.send({event:"cpu.status"}).then((function(t){var n=t.stepping,s=t.paused,r=0!==t.pc||n;e.setState({connected:!0,started:r,paused:s})}),(function(t){e.setState({paused:!0})}))}}]),n}(s.PureComponent));Fe.contextType=w;var Ee=Fe;n(456);function Ue(e){var t=Object(S.jsxs)("div",{className:"NotConnected__main",children:[e.connecting?"Connecting to PPSSPP...":"Not connected to PPSSPP",Object(S.jsx)("div",{className:"NotConnected__info",children:'Make sure "Allow remote debugger" is enabled in Developer tools.'}),Object(S.jsxs)("form",{className:"NotConnected__form",onSubmit:function(t){var n=t.target.elements["debugger-uri"].value;e.connect(n),t.preventDefault()},children:[Object(S.jsx)("input",{type:"text",name:"debugger-uri",placeholder:"ws://ip:port/debugger",className:"NotConnected__uri"}),Object(S.jsx)("button",{type:"submit",disabled:e.connecting,children:"Connect Manually"})]}),Object(S.jsx)("form",{className:"NotConnected__form",onSubmit:function(t){e.connect(null),t.preventDefault()},children:Object(S.jsx)("button",{type:"submit",disabled:e.connecting,children:"Connect Automatically"})})]}),n=Object(S.jsx)("div",{className:"NotConnected__utilityPanel App-utilityPanel",children:Object(S.jsx)(Me,{})});return Object(S.jsxs)("div",{id:"NotConnected",children:[t,n]})}var Ie=n.p+"static/media/logo.94f885ce.svg",He=(n(457),{name:"ppsspp-debugger",version:"1.0.0"}),Ge=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).state={connected:!1,connecting:!1,gameStatus:null},s.handleAutoConnect=function(){s.connect(null)},s.connect=function(e){s.setState({connecting:!0}),s.ppsspp.onClose=function(){s.log("Debugger disconnected"),k.change(!1),s.setState({connected:!1,connecting:!1})},(null===e?s.ppsspp.autoConnect():s.ppsspp.connect(e)).then((function(){s.log("Debugger connected"),k.change(!0),s.setState({connected:!0,connecting:!1})}),(function(e){s.log("Debugger could not connect"),k.change(!1),s.setState({connected:!1,connecting:!1})}))},s.handleDisconnect=function(){s.ppsspp.disconnect()},s.log=function(e){Re.addLogItem({message:e+"\n"})},s.updateTitle=function(e){document&&(e.game?document.title=s.originalTitle+" - "+e.game.id+": "+e.game.title:document.title=s.originalTitle)},s.onConnectionChange=function(e){e?(s.ppsspp.send(Object(c.a)({event:"version"},He)).catch((function(e){window.alert("PPSSPP seems to think this debugger is out of date.  Try refreshing?\n\nDetails: "+e)})),s.ppsspp.send({event:"game.status"}).then(s.updateTitle,(function(e){return s.updateTitle({})}))):s.updateTitle({})},s.ppsspp=new y,s.gameStatus=new x,s.originalTitle=document.title,k.init(s.ppsspp),k.listen({"connection.change":s.onConnectionChange,"game.start":s.updateTitle,"game.quit":s.updateTitle}),Re.init(s.ppsspp),s.gameStatus.init(s.ppsspp),s.gameStatus.listenState((function(e){s.setState({gameStatus:e})})),s}return Object(u.a)(n,[{key:"render",value:function(){return Object(S.jsx)(h.a,{children:Object(S.jsx)(T,{gameStatus:this.state.gameStatus,log:this.log,ppsspp:this.ppsspp,children:Object(S.jsxs)("div",{className:"App",children:[Object(S.jsxs)("header",{className:"App-header",children:[Object(S.jsxs)("ul",{className:"App-nav",children:[Object(S.jsx)(h.b,{to:"/cpu",isActive:function(e,t){return e||"/"===t.pathname},children:"CPU"}),Object(S.jsx)(h.b,{to:"/gpu",children:"GPU"})]}),Object(S.jsx)("img",{src:Ie,className:"App-logo",alt:"PPSSPP"}),Object(S.jsx)("h1",{className:"App-title",children:"Debugger"})]}),this.renderContent()]})})})}},{key:"renderContent",value:function(){return this.state.connected?Object(S.jsxs)(f.c,{children:[Object(S.jsx)(f.a,{path:"/gpu",children:Object(S.jsx)(Ee,{})}),Object(S.jsx)(f.a,{children:Object(S.jsx)(Ve,{})})]}):Object(S.jsx)(Ue,{connecting:this.state.connecting,connect:this.connect})}},{key:"componentDidMount",value:function(){this.props.testing||this.handleAutoConnect()}}]),n}(s.Component),ze=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function qe(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(389),n(460),n(468);a.a.render(Object(S.jsx)(Ge,{}),document.getElementById("root")),o.a.setAppElement("#root"),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");ze?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):qe(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):qe(e)}))}}()}},[[472,1,2]]]);
//# sourceMappingURL=main.0824bd76.chunk.js.map